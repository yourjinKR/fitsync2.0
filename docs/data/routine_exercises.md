# routine_exercises

## 1. 테이블 개요 (Table Overview)
| 항목 | 내용 |
| :--- | :--- |
| **테이블 명** | `routine_exercises` |
| **설명** | 특정 루틴(`routines`)에 어떤 운동(`exercises`)이 포함되는지를 연결하고, 해당 루틴 내에서 운동의 순서를 정의하는 테이블입니다. 상세한 세트 정보는 `routine_sets` 테이블에서 관리됩니다. |

## 2. 컬럼 명세 (Column Specification)
- `id`: 루틴 운동 항목의 고유 ID (Primary Key)
- `routine_id`: 소속된 루틴의 ID (`routines.id` 참조)
- `exercise_id`: 수행할 운동의 ID (`exercises.id` 참조)
- `display_order`: 루틴 내에서 운동이 표시될 순서 (0부터 시작)
- `memo`: 해당 운동에 대한 추가적인 메모 (예: '마지막 세트는 드롭세트로 진행')

## 3. 관계 (Relations)
- **`routines` (N:1)**: `routine_id` 컬럼을 통해 `routines` 테이블을 참조합니다.
- **`exercises` (N:1)**: `exercise_id` 컬럼을 통해 `exercises` 테이블을 참조합니다.
- **`routine_sets` (1:N)**: 하나의 루틴 운동 항목은 여러 개의 상세 세트(`routine_sets`)를 가질 수 있습니다.

## 4. 인덱스 (Indexes)
| 인덱스 명 | 컬럼 | 설명 |
| :--- | :--- | :--- |
| `idx_routine_exercises_routine_id` | `(routine_id)` | 특정 루틴에 포함된 모든 운동을 빠르게 조회하기 위해 사용됩니다. |

## 5. DDL 쿼리문 (DDL Query)
```sql
-- 테이블이 이미 존재할 경우 삭제
DROP TABLE IF EXISTS routine_exercises CASCADE;

-- routine_exercises 테이블 생성
CREATE TABLE routine_exercises (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    routine_id BIGINT NOT NULL,
    exercise_id BIGINT NOT NULL,
    display_order SMALLINT NOT NULL DEFAULT 0,
    memo TEXT,
    CONSTRAINT fk_re_routine FOREIGN KEY(routine_id) REFERENCES routines(id) ON DELETE CASCADE,
    CONSTRAINT fk_re_exercise FOREIGN KEY(exercise_id) REFERENCES exercises(id) ON DELETE CASCADE
);

-- 인덱스 생성
CREATE INDEX idx_routine_exercises_routine_id ON routine_exercises(routine_id);

-- 주석 추가
COMMENT ON TABLE routine_exercises IS '루틴과 운동을 연결하고, 루틴 내 운동 순서를 정의하는 테이블';
COMMENT ON COLUMN routine_exercises.routine_id IS '소속된 루틴의 ID (routines.id 참조)';
COMMENT ON COLUMN routine_exercises.exercise_id IS '수행할 운동의 ID (exercises.id 참조)';
COMMENT ON COLUMN routine_exercises.display_order IS '루틴 내 운동 순서 (0부터 시작)';
```