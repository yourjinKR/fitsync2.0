# exercise_instructions

## 1. 테이블 개요 (Table Overview)
| 항목 | 내용 |
| :--- | :--- |
| **테이블 명** | `exercise_instructions` |
| **설명** | 개별 운동의 수행 방법을 순서가 있는 단계별 목록으로 저장하는 테이블입니다. `exercises` 테이블의 설명을 구조적으로 관리합니다. |

## 2. 컬럼 명세 (Column Specification)
- `id`: 단계별 설명 고유 ID (Primary Key)
- `exercise_id`: 연관된 운동의 ID (`exercises.id` FK)
- `step_order`: 단계 순서 (1, 2, 3...)
- `description`: 해당 단계의 상세 설명
- `created_at`: 레코드 생성일시

## 3. 관계 (Relations)
- **`exercises` (N:1)**: 여러 단계별 설명은 하나의 운동에 속합니다.

## 4. 인덱스 (Indexes)
| 인덱스 명 | 컬럼 | 설명 |
| :--- | :--- | :--- |
| `idx_instructions_exercise_order` | `(exercise_id, step_order)` | 특정 운동에 속한 설명들을 순서대로 빠르게 조회하기 위한 복합 인덱스입니다. |

## 5. DDL 쿼리문 (DDL Query)
```sql
-- 테이블이 이미 존재할 경우 삭제
DROP TABLE IF EXISTS exercise_instructions CASCADE;

-- exercise_instructions 테이블 생성
CREATE TABLE exercise_instructions (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    exercise_id BIGINT NOT NULL,
    step_order SMALLINT NOT NULL,
    description TEXT NOT NULL,
    created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT CURRENT_TIMESTAMP,

    -- 외래 키 제약 조건: exercise가 삭제되면 관련 설명도 함께 삭제 (CASCADE)
    CONSTRAINT fk_exercise_instruction FOREIGN KEY(exercise_id) REFERENCES exercises(id) ON DELETE CASCADE
);

-- 인덱스 생성
CREATE INDEX idx_instructions_exercise_order ON exercise_instructions(exercise_id, step_order);

-- 주석 추가
COMMENT ON TABLE exercise_instructions IS '운동별 수행 방법을 순서가 있는 단계별로 저장하는 테이블';
COMMENT ON COLUMN exercise_instructions.exercise_id IS '연관된 운동의 ID (exercises.id)';
COMMENT ON COLUMN exercise_instructions.step_order IS '운동 방법의 단계 순서 (1부터 시작)';
COMMENT ON COLUMN exercise_instructions.description IS '해당 단계의 상세 설명';
```