# workout_sets

## 1. 테이블 개요 (Table Overview)
| 항목 | 내용 |
| :--- | :--- |
| **테이블 명** | `workout_sets` |
| **설명** | `workout_exercises`에 포함된 세트별 실제 수행 기록을 저장하는 테이블입니다. 근력 운동(무게·횟수)과 유산소 운동(거리·시간)을 모두 기록할 수 있습니다. |

---

## 2. 컬럼 명세 (Column Specification)
- `id`: 세트 고유 ID (Primary Key)  
- `workout_exercise_id`: 소속된 운동 기록 항목의 ID (`workout_exercises.id` 참조)  
- `weight_kg`: **근력 운동용** 해당 세트의 중량(kg)  
- `reps`: **근력 운동용** 반복 횟수  
- `distance_m`: **유산소 운동용** 거리(m)  
- `duration_sec`: **유산소 운동용** 시간(초)  

---

## 3. 관계 (Relations)
- **`workout_exercises` (N:1)**  
  - `workout_exercise_id`를 통해 소속된 운동(`workout_exercises.id`) 참조  
- **1 세트 단위 기록**  
  - 하나의 `workout_exercises`는 여러 개의 `workout_sets`를 가질 수 있음  

---

## 4. 인덱스 (Indexes)
| 인덱스 명 | 컬럼 | 설명 |
| :--- | :--- | :--- |
| `idx_wset_wex` | `(workout_exercise_id)` | 특정 운동 항목에 속한 모든 세트를 빠르게 조회하기 위해 사용 |

---

## 5. DDL 쿼리문 (DDL Query)
```sql
-- 테이블이 이미 존재할 경우 삭제
DROP TABLE IF EXISTS workout_sets CASCADE;

-- workout_sets 테이블 생성
CREATE TABLE workout_sets (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    workout_exercise_id BIGINT NOT NULL,

    -- 근력 메트릭
    weight_kg NUMERIC(10,2),
    reps INTEGER,

    -- 유산소 메트릭
    distance_m INTEGER,
    duration_sec INTEGER,

    CONSTRAINT fk_wset_wex FOREIGN KEY (workout_exercise_id) REFERENCES workout_exercises(id) ON DELETE CASCADE,

    -- 음수 방지
    CONSTRAINT chk_wset_nonneg CHECK (
        (weight_kg IS NULL OR weight_kg >= 0)
        AND (reps IS NULL OR reps >= 0)
        AND (distance_m IS NULL OR distance_m >= 0)
        AND (duration_sec IS NULL OR duration_sec >= 0)
    )
);

-- 운동-세트 조회 인덱스
CREATE INDEX idx_wset_wex ON workout_sets(workout_exercise_id);

-- 주석 추가
COMMENT ON TABLE workout_sets IS '세트별 실제 수행 기록';
COMMENT ON COLUMN workout_sets.workout_exercise_id IS '소속된 운동 기록 항목의 ID (workout_exercises.id 참조)';
COMMENT ON COLUMN workout_sets.weight_kg IS '근력 운동용: 세트 중량 (kg)';
COMMENT ON COLUMN workout_sets.reps IS '근력 운동용: 반복 횟수';
COMMENT ON COLUMN workout_sets.distance_m IS '유산소 운동용: 세트 거리 (m)';
COMMENT ON COLUMN workout_sets.duration_sec IS '유산소 운동용: 세트 시간 (초)';
```