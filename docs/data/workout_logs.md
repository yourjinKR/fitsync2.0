# workout_logs

## 1. 테이블 개요 (Table Overview)
| 항목 | 내용 |
| :--- | :--- |
| **테이블 명** | `workout_logs` |
| **설명** | 특정 운동 세션(`workout_sessions`)에서 사용자가 실제로 수행한 각 세트의 결과를 기록하는 테이블입니다. 운동 일지의 가장 상세한 데이터를 담당합니다. |

## 2. 컬럼 명세 (Column Specification)
- `id`: 운동 기록 고유 ID (Primary Key)
- `session_id`: 소속된 운동 세션의 ID (`workout_sessions.id` 참조)
- `exercise_id`: 수행한 운동의 ID (`exercises.id` 참조)
- `set_number`: 해당 운동 내에서의 세트 번호 (1세트, 2세트, ...)
- `weight_kg`: **(근력)** 실제 사용한 중량 (kg)
- `reps`: **(근력)** 실제 반복 횟수
- `distance_km`: **(유산소)** 실제 이동한 거리 (km)
- `duration_min`: **(유산소)** 실제 소요된 시간 (분)
- `is_completed`: 세트 완료 여부 (성공/실패 체크)
- `log_time`: 해당 세트를 완료한 시각

## 3. 관계 (Relations)
- **`workout_sessions` (N:1)**: `session_id` 컬럼을 통해 `workout_sessions` 테이블을 참조합니다.
- **`exercises` (N:1)**: `exercise_id` 컬럼을 통해 `exercises` 테이블을 참조합니다.

## 4. 인덱스 (Indexes)
| 인덱스 명 | 컬럼 | 설명 |
| :--- | :--- | :--- |
| `idx_workout_logs_session_id` | `(session_id)` | 특정 운동 세션에 포함된 모든 세트 기록을 빠르게 조회하기 위해 사용됩니다. |

## 5. DDL 쿼리문 (DDL Query)
```sql
-- 테이블이 이미 존재할 경우 삭제
DROP TABLE IF EXISTS workout_logs CASCADE;

-- workout_logs 테이블 생성
CREATE TABLE workout_logs (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    session_id BIGINT NOT NULL,
    exercise_id BIGINT NOT NULL,
    set_number SMALLINT NOT NULL,
    
    -- 근력 운동 기록 (유산소 운동 시 NULL)
    weight_kg DECIMAL(10, 2),
    reps SMALLINT,
    
    -- 유산소 운동 기록 (근력 운동 시 NULL)
    distance_km DECIMAL(10, 2),
    duration_min SMALLINT,

    is_completed BOOLEAN NOT NULL DEFAULT true,
    log_time TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT CURRENT_TIMESTAMP,

    CONSTRAINT fk_log_session FOREIGN KEY(session_id) REFERENCES workout_sessions(id) ON DELETE CASCADE,
    CONSTRAINT fk_log_exercise FOREIGN KEY(exercise_id) REFERENCES exercises(id) ON DELETE RESTRICT
);

-- 인덱스 생성
CREATE INDEX idx_workout_logs_session_id ON workout_logs(session_id);

-- 주석 추가
COMMENT ON TABLE workout_logs IS '실제로 수행한 각 운동 세트의 결과를 기록하는 테이블';
COMMENT ON COLUMN workout_logs.session_id IS '소속된 운동 세션 ID (workout_sessions.id 참조)';
COMMENT ON COLUMN workout_logs.exercise_id IS '수행한 운동 ID (exercises.id 참조)';
COMMENT ON COLUMN workout_logs.set_number IS '해당 운동 내에서의 세트 번호 (1부터 시작)';
COMMENT ON COLUMN workout_logs.weight_kg IS '실제 사용한 중량 (kg)';
COMMENT ON COLUMN workout_logs.reps IS '실제 반복 횟수';
COMMENT ON COLUMN workout_logs.distance_km IS '실제 이동 거리 (km)';
COMMENT ON COLUMN workout_logs.duration_min IS '실제 소요 시간 (분)';
COMMENT ON COLUMN workout_logs.is_completed IS '세트 완료 여부 (true: 성공, false: 실패)';